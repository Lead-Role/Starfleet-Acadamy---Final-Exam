<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Starfleet Academy Exam</title>
    <style>
        @import url("https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap");

        html, body {
    height: 100%;
    margin: 0;
    padding: 0;
}

body {
    display: flex;
    flex-direction: column;
    background-color: #000000;
    font-family: "Orbitron", sans-serif;
    color: #ffcc33;
    text-align: center;
    overflow-x: hidden;
}

.lcars-title-bar {
    background-color: #ffd700;
    font-weight: bold;
    padding: 10px;
    text-align: center;
    border-bottom: 4px solid #663300;
}

.lcars-title {
    font-size: 20pt;
    color: #000000;
    letter-spacing: 2px;
    text-transform: uppercase;
}

.lcars-container {
    display: flex;
    flex-grow: 1;
    justify-content: space-between;
}

.lcars-sidebar {
    width: 350px;
    height: 600px;
    background-color: #152238;
    padding: 2px;
    color: #ff9933;
    border-radius: 25px;
    background-image: url('https://raw.githubusercontent.com/Lead-Role/Starfleet-Acadamy---Final-Exam/refs/heads/main/LCARS%20-%20Starfleet%20Academy%20Exams.png');
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
    position: relative;
    text-align: center;
    flex-shrink: 0;
    overflow: hidden;
}

.lcars-sidebar p {
    margin: 0;
    padding: 0;
}

.lcars-main {
    flex-grow: 1;
    background-color: #000000;
    padding: 50px 50px 3px 50px;
    color: #ffcc33;
    border: 4px solid #ff9933;
    border-radius: 25px;
    box-sizing: border-box;
    overflow-y: hidden;
    font-family: Arial, sans-serif;
}

.lcars-footer {
    background-color: #800020;
    padding: 15px 0;
    color: #ffff00;
    position: fixed;
    bottom: 0;
    width: 100%;
    text-align: center;
    border-top: 4px solid #ff9933;
    font-size: 16pt;
    font-weight: bold;
    box-sizing: border-box;
    line-height: 1.2;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.lcars-footer #stardate {
    text-align: left;
    padding-left: 30px;
    color: #ffffff;
    font-size: 14pt;
    position: absolute;
    bottom: 15px; /* Aligns with the bottom padding of the footer */
    left: 30px;
}

button {
    font-size: 14pt;
    background-color: #003366;
    color: #ffcc33;
    border: 2px solid white;
    padding: 8px 16px;
    margin: 10px;
    cursor: pointer;
    border-radius: 10px;
    transition: all 0.2s ease;
}

button:hover {
    background-color: #ff9933;
    color: #000000;
}

button.question-button {
    width: 150px;
    font-family: Arial, sans-serif;
    font-size: 16pt;
    color: #ffd700;
    background: linear-gradient(to bottom, #444444, #000000);
    border: 4px solid #ffd700;
    padding: 10px 0;
    margin: 10px;
    cursor: pointer;
    border-radius: 6px;
    box-shadow: 2px 2px 5px #ffffff;
    transition: all 0.3s ease;
    text-align: center;
}

button.question-button:hover {
    background: linear-gradient(to bottom, #000000, #444444);
    box-shadow: 2px 2px 7px #ffffff;
    transform: translateY(-2px);
}

.description {
    font-size: 18pt;
    margin: 20px 0;
}

.question-count {
    font-size: 16pt;
    margin-top: 75px;
}

.button-container {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 15px;
    margin-top: 50px;
}

.lcars-category,
.lcars-description {
    background-color: #000039;
    font-size: 15pt;
    color: gold;
    font-family: Arial, sans-serif;
    padding: 10px;
    border-radius: 5px;
    margin-bottom: 10px;
}

.feedback-question {
    font-family: "Orbitron", sans-serif;
    font-size: 20pt;
    color: gold;
    text-align: center;
}

.feedback-message.correct {
    color: limegreen;
}

.feedback-message.incorrect {
    color: tomato;
}

.feedback-message {
    font-family: Arial, sans-serif;
    font-size: 18pt;
    margin-top: 60px;
    text-align: center;
}

.feedback-narrative {
    font-family: Arial, sans-serif;
    font-size: 16pt;
    color: white;
    margin-top: 60px;
    text-align: center;
}

.feedback-score {
    font-family: Arial, sans-serif;
    font-size: 20pt;
    color: gold;
    margin-top: 60px;
    text-align: center;
}


.feedback-image {
    width: 150px;
    height: 150px;
    position: absolute;
    bottom: 130px; /* Moved up an additional 100px from the previous 30px */
    left: calc(350px + 50px); /* 350px for the sidebar width, 50px for padding */
}



.feedback-next-button {
    padding: 10px 15px;
    font-size: 14pt;
    background-color: #003366;
    color: #ffcc33;
    border: 2px solid white;
    border-radius: 10px;
    cursor: pointer;
    position: absolute;
    top: calc(100% - 130px - 75px); /* Centers vertically on the middle of the image (half the image height) */
    right: 150px; /* 150px from the right side margin */
    transition: all 0.2s ease;
}

.feedback-next-button:hover {
    background-color: #ff9933;
    color: #000000;
}


    </style>
</head>
<body>
    <div class="lcars-title-bar">
        <div class="lcars-title">Starfleet Academy Exam System</div>
    </div>

    <div class="lcars-container">
        <div class="lcars-sidebar"></div>

        <div id="main-content" class="lcars-main">
            <div class="description">
                This is your final step to qualify for promotion. Select your examination level below.
            </div>
            <div class="question-count">
                Ensigns = 10 Questions / Lieutenants = 25 Questions / Commanders = 50 Questions
            </div>
            <div class="button-container">
                <button class="question-button">Ensign</button>
                <button class="question-button">Lieutenant</button>
                <button class="question-button">Commander</button>
            </div>
        </div>

        <div id="feedback-page" class="lcars-main" style="display: none;">
        </div>
    </div>

    <div class="lcars-footer">
        <div id="stardate-container">
            <p id="stardate">Star Date: 52174.2</p>
        </div>
        <p>LCARS Terminal - Authorized Personnel Only</p>
    </div>

    <script type="module">
        document.addEventListener('DOMContentLoaded', () => {
            loadQuestions();
            setupMainPageEventListeners();

            let stardate = 52174.2;
            setInterval(() => {
                stardate = parseFloat((stardate + 0.1).toFixed(1));
                document.getElementById('stardate').innerHTML = `Star Date:<br>${stardate.toFixed(1)}`;
            }, 5000);
        });

        let allQuestions = [];

        function loadQuestions() {
            fetch('https://raw.githubusercontent.com/Lead-Role/Starfleet-Acadamy---Final-Exam/refs/heads/main/Starfleet%20Academy%20101.json')
                .then(response => response.json())
                .then(data => {
                    allQuestions = data;
                })
                .catch(error => console.error('Error fetching questions:', error));
        }

        function setupMainPageEventListeners() {
            document.querySelectorAll('.question-button').forEach(button => {
                button.addEventListener('click', (event) => {
                    const level = event.target.textContent;
                    let numberOfQuestions;

                    if (level === 'Ensign') {
                        numberOfQuestions = 10;
                    } else if (level === 'Lieutenant') {
                        numberOfQuestions = 25;
                    } else if (level === 'Commander') {
                        numberOfQuestions = 50;
                    }

                    startExam(numberOfQuestions);
                });
            });
        }

        function startExam(numberOfQuestions) {
            const shuffledQuestions = shuffleArray(allQuestions).slice(0, numberOfQuestions);
            displayQuestions(shuffledQuestions);
        }

        function shuffleArray(array) {
            return array
                .map(value => ({ value, sort: Math.random() }))
                .sort((a, b) => a.sort - b.sort)
                .map(({ value }) => value);
        }

        function displayQuestions(questions) {
            let currentQuestionIndex = 0;
            let correctAnswers = 0;
            let incorrectAnswers = 0;

            function showQuestion() {
                if (currentQuestionIndex >= questions.length) {
                    showQuizComplete(correctAnswers, questions.length);
                    return;
                }

                document.getElementById('main-content').style.display = 'block';
                document.getElementById('feedback-page').style.display = 'none';

                const question = questions[currentQuestionIndex];
                const answers = [
                    { text: question['Answer 1'], isCorrect: question['Answer 1'] === question['Correct Answer'] },
                    { text: question['Answer 2'], isCorrect: question['Answer 2'] === question['Correct Answer'] },
                    { text: question['Answer 3'], isCorrect: question['Answer 3'] === question['Correct Answer'] },
                    { text: question['Answer 4'], isCorrect: question['Answer 4'] === question['Correct Answer'] }
                ];

                const mainContent = document.getElementById('main-content');
                mainContent.innerHTML = `
                    <div class="lcars-category" style="background-color: #000039; font-size: 15pt; color: gold; font-family: Arial; margin-bottom: 10px; padding: 10px;">Category: ${question['Series / Movie']}</div>
                    <div class="lcars-description" style="background-color: #000039; font-size: 15pt; color: gold; font-family: Arial; margin-bottom: 20px; padding: 10px;">Description: ${question.Description}</div>
                    <div class="lcars-question" style="font-family: Arial; font-size: 18pt; color: gold; margin-top: 20px;">${question.Question}</div>
                    <div class="lcars-answer-container" style="display: flex; flex-direction: column; gap: 10px; margin-top: 20px;">
                        ${answers.map(answer =>
                            `<button class="answer-button" data-correct="${answer.isCorrect}" style="padding: 10px 15px; font-size: 14pt;">${answer.text}</button>`
                        ).join('')}
                    </div>
                `;

                document.querySelectorAll('.answer-button').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const isCorrect = event.target.getAttribute('data-correct') === 'true';

                        if (isCorrect) {
                            correctAnswers++;
                        } else {
                            incorrectAnswers++;
                        }

                        displayFeedbackPage(question, isCorrect);
                    });
                });
            }

            function displayFeedbackPage(question, isCorrect) {
                document.getElementById('main-content').style.display = 'none';
                document.getElementById('feedback-page').style.display = 'block';

                const correctAnswer = question['Correct Answer'];
                const feedbackText = isCorrect
                    ? `Correct: ${correctAnswer}`
                    : `Incorrect: The correct answer was ${correctAnswer}`;
                const feedbackClass = isCorrect ? "correct" : "incorrect";
                const narrative = question['Narrative'] || "No additional information.";

                const totalAnswered = correctAnswers + incorrectAnswers;
                const scoreText = `Your Score: Total Answered: ${totalAnswered}, Total Correct: ${correctAnswers}, Total Incorrect: ${incorrectAnswers}`;

                const feedbackImage = isCorrect
                    ? 'https://raw.githubusercontent.com/Lead-Role/Starfleet-Acadamy---Final-Exam/refs/heads/main/Correct%20Answer.gif'
                    : 'https://raw.githubusercontent.com/Lead-Role/Starfleet-Acadamy---Final-Exam/refs/heads/main/Incorrect%20Answer.gif';

                const feedbackContent = document.getElementById('feedback-page');
                feedbackContent.innerHTML = `
                    <div class="feedback-container">
                        <img class="feedback-image" src="${feedbackImage}" alt="${isCorrect ? 'Correct Answer' : 'Incorrect Answer'}" />
                        <div class="feedback-content">
                            <div class="feedback-question">${question.Question}</div>
                            <div class="feedback-message ${feedbackClass}">${feedbackText}</div>
                            <div class="feedback-narrative">${narrative}</div>
                            <div class="feedback-score">${scoreText}</div>
                            <button class="feedback-next-button">Next Question</button>
                        </div>
                    </div>
                `;

                document.querySelector('.feedback-next-button').addEventListener('click', () => {
                    currentQuestionIndex++;
                    showQuestion();
                });
            }

            showQuestion();
        }

        function showQuizComplete(correctAnswers, totalQuestions) {
            const mainContent = document.getElementById('main-content');
            const scorePercentage = (correctAnswers / totalQuestions) * 100;

            mainContent.innerHTML = `
                <div style="font-size: 24pt; color: gold; margin-bottom: 20px;">Exam Complete</div>
                <div style="font-size: 20pt; color: white;">You scored ${correctAnswers} out of ${totalQuestions} (${scorePercentage.toFixed(2)}%)</div>
            `;
        }
    </script>
</body>
</html>
